<!doctype html>
<html>
<head><meta charset="utf-8"><title>Credits - NCCR Portal v2</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="assets/styles.css"></head>
<body onload="requireAuth()">
  <div class="topbar"><div class="brand"><div class="logo-badge">N</div> NCCR Portal</div><div class="top-actions"><div id="header-user" class="small"></div><button id="logout-btn" class="btn">Logout</button></div></div>
  <div class="app">
    <aside class="sidebar"><div style="font-weight:700">Navigation</div><div class="nav"><a href="dashboard.html">Dashboard</a><a href="projects.html">Projects</a><a href="ngos.html">NGOs</a><a href="credits.html" class="active">Credits</a><a href="trading.html">Trading</a><a href="profile.html">Profile</a><a href="notifications.html">Notifications</a></div></aside>
    <main class="main">
      <div class="header-row"><div><h2>Credits</h2><div class="small">Issued carbon credits</div></div><div><button id="exportBtn" class="btn-primary">Export CSV</button></div></div>
      <div class="card"><div class="table-wrap"><table class="table" id="creditsTable"><thead><tr><th>ID</th><th>Project ID</th><th>Amount</th><th>Owner</th><th>Issued</th></tr></thead><tbody></tbody></table></div></div>
    </main>
  </div>

<script src="assets/app.js"></script>
<script>
requireAuth();
const data = NCCR.ensureDemoData();
function render(){
  const tbody = document.querySelector('#creditsTable tbody');
  tbody.innerHTML = '';
  data.credits.forEach(c=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${c.id}</td><td>${c.project}</td><td>${NCCR.formatNumber(c.amount)}</td><td>${c.owner}</td><td>${c.issued}</td>`;
    tbody.appendChild(tr);
  });
}
document.getElementById('exportBtn').addEventListener('click', ()=>{
  const csv = ['ID,Project,Amount,Owner,Issued', ...data.credits.map(c=>`${c.id},${c.project},${c.amount},${c.owner},${c.issued}`)].join('\n');
  const blob = new Blob([csv], {type:'text/csv'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'credits.csv';
  a.click();
});
render();
</script>
</body>
</html>
